2024-02-08 12:51:19.474521: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-08 12:51:20.205808: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.1.0) or chardet (5.2.0) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
I0208 12:51:22.372179 139825116837696 tfrecords_realworldhar.py:130] [INFO] Records already exists
wandb: Currently logged in as: utsavpanchal (dl-lab-uni-stuttgart). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.3 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /home/RUS_CIP/st184584/dl-lab-23w-team10/human_activity_recognition/wandb/run-20240208_125123-cgeepejv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643
wandb: ⭐️ View project at https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy
wandb: 🚀 View run at https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy/runs/cgeepejv
I0208 12:51:23.751275 139825116837696 datasets.py:35] Preparing dataset har...
2024-02-08 12:51:23.877568: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9802 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
I0208 12:51:26.314868 139825116837696 main.py:65] [DATASET loaded!] har
(None, 250, 6)
(None, 8)
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 lstm (LSTM)                 (None, 250, 128)          69120     
                                                                 
 batch_normalization (Batch  (None, 250, 128)          512       
 Normalization)                                                  
                                                                 
 lstm_1 (LSTM)               (None, 250, 128)          131584    
                                                                 
 batch_normalization_1 (Bat  (None, 250, 128)          512       
 chNormalization)                                                
                                                                 
 lstm_2 (LSTM)               (None, 128)               131584    
                                                                 
 batch_normalization_2 (Bat  (None, 128)               512       
 chNormalization)                                                
                                                                 
 dense (Dense)               (None, 16)                2064      
                                                                 
 dropout (Dropout)           (None, 16)                0         
                                                                 
 dense_1 (Dense)             (None, 8)                 136       
                                                                 
=================================================================
Total params: 336024 (1.28 MB)
Trainable params: 335256 (1.28 MB)
Non-trainable params: 768 (3.00 KB)
_________________________________________________________________
I0208 12:51:26.741564 139825116837696 main.py:91] Starting model training...
I0208 12:51:26.742096 139825116837696 train.py:26] Initializing from scratch. Checkpoints stored in /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts
2024-02-08 12:51:29.371344: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:432] Loaded cuDNN version 8600
2024-02-08 12:51:29.650426: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f2a18459810 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2024-02-08 12:51:29.650473: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 2080 Ti, Compute Capability 7.5
2024-02-08 12:51:29.667602: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:255] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2024-02-08 12:51:29.862827: I ./tensorflow/compiler/jit/device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
I0208 12:51:37.147606 139825116837696 train.py:97] Step 50, Time 1.90, Loss: 1.27, Accuracy: 55.90, Validation Loss: 1.71, Validation Accuracy: 40.92
I0208 12:51:37.150677 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:51:40.401597 139825116837696 train.py:97] Step 100, Time 0.20, Loss: 0.63, Accuracy: 79.25, Validation Loss: 2.12, Validation Accuracy: 39.09
I0208 12:51:40.405229 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:51:43.521065 139825116837696 train.py:97] Step 150, Time 0.19, Loss: 0.49, Accuracy: 85.00, Validation Loss: 2.35, Validation Accuracy: 58.81
I0208 12:51:43.525578 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:51:46.679318 139825116837696 train.py:97] Step 200, Time 0.19, Loss: 0.41, Accuracy: 87.66, Validation Loss: 1.57, Validation Accuracy: 64.11
I0208 12:51:46.683425 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:51:49.853567 139825116837696 train.py:97] Step 250, Time 0.20, Loss: 0.36, Accuracy: 88.73, Validation Loss: 0.78, Validation Accuracy: 72.61
I0208 12:51:49.857283 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:51:53.013279 139825116837696 train.py:97] Step 300, Time 0.20, Loss: 0.66, Accuracy: 82.83, Validation Loss: 1.16, Validation Accuracy: 58.92
I0208 12:51:53.017872 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:51:56.202362 139825116837696 train.py:97] Step 350, Time 0.20, Loss: 0.40, Accuracy: 88.09, Validation Loss: 0.76, Validation Accuracy: 66.70
I0208 12:51:56.206016 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:51:59.363285 139825116837696 train.py:97] Step 400, Time 0.20, Loss: 0.33, Accuracy: 90.02, Validation Loss: 0.87, Validation Accuracy: 71.78
I0208 12:51:59.366837 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:02.567510 139825116837696 train.py:97] Step 450, Time 0.20, Loss: 0.29, Accuracy: 91.17, Validation Loss: 0.76, Validation Accuracy: 70.35
I0208 12:52:02.571899 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:05.781945 139825116837696 train.py:97] Step 500, Time 0.20, Loss: 0.26, Accuracy: 91.82, Validation Loss: 0.81, Validation Accuracy: 77.08
I0208 12:52:05.785749 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:08.969239 139825116837696 train.py:97] Step 550, Time 0.20, Loss: 0.25, Accuracy: 92.26, Validation Loss: 0.72, Validation Accuracy: 77.03
I0208 12:52:08.972215 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:12.191119 139825116837696 train.py:97] Step 600, Time 0.20, Loss: 0.24, Accuracy: 92.81, Validation Loss: 0.76, Validation Accuracy: 78.24
I0208 12:52:12.194707 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:15.384597 139825116837696 train.py:97] Step 650, Time 0.20, Loss: 0.25, Accuracy: 92.79, Validation Loss: 0.64, Validation Accuracy: 77.69
I0208 12:52:15.386998 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:18.611937 139825116837696 train.py:97] Step 700, Time 0.20, Loss: 0.22, Accuracy: 93.49, Validation Loss: 0.51, Validation Accuracy: 88.13
I0208 12:52:18.615479 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:21.861939 139825116837696 train.py:97] Step 750, Time 0.20, Loss: 0.22, Accuracy: 93.35, Validation Loss: 0.69, Validation Accuracy: 83.05
I0208 12:52:21.866532 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:25.084744 139825116837696 train.py:97] Step 800, Time 0.20, Loss: 0.25, Accuracy: 92.47, Validation Loss: 1.08, Validation Accuracy: 73.94
I0208 12:52:25.089749 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:28.488357 139825116837696 train.py:97] Step 850, Time 0.20, Loss: 0.22, Accuracy: 93.08, Validation Loss: 1.15, Validation Accuracy: 68.08
I0208 12:52:28.492092 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:31.717755 139825116837696 train.py:97] Step 900, Time 0.15, Loss: 0.23, Accuracy: 93.11, Validation Loss: 0.77, Validation Accuracy: 77.36
I0208 12:52:31.720468 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:34.977656 139825116837696 train.py:97] Step 950, Time 0.20, Loss: 0.20, Accuracy: 93.83, Validation Loss: 0.96, Validation Accuracy: 74.05
I0208 12:52:34.980882 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:38.242962 139825116837696 train.py:97] Step 1000, Time 0.20, Loss: 0.19, Accuracy: 93.91, Validation Loss: 0.75, Validation Accuracy: 79.96
I0208 12:52:38.245417 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:41.486527 139825116837696 train.py:97] Step 1050, Time 0.20, Loss: 0.17, Accuracy: 94.38, Validation Loss: 0.94, Validation Accuracy: 75.70
I0208 12:52:41.490247 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:44.776121 139825116837696 train.py:97] Step 1100, Time 0.20, Loss: 0.18, Accuracy: 94.45, Validation Loss: 0.91, Validation Accuracy: 76.37
I0208 12:52:44.779518 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:48.064405 139825116837696 train.py:97] Step 1150, Time 0.20, Loss: 0.18, Accuracy: 94.14, Validation Loss: 0.77, Validation Accuracy: 81.78
I0208 12:52:48.068254 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:51.312444 139825116837696 train.py:97] Step 1200, Time 0.20, Loss: 0.16, Accuracy: 94.82, Validation Loss: 0.59, Validation Accuracy: 85.31
I0208 12:52:51.316486 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:54.604725 139825116837696 train.py:97] Step 1250, Time 0.20, Loss: 0.17, Accuracy: 94.70, Validation Loss: 0.43, Validation Accuracy: 87.36
I0208 12:52:54.608254 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:52:57.860971 139825116837696 train.py:97] Step 1300, Time 0.20, Loss: 0.17, Accuracy: 94.95, Validation Loss: 0.74, Validation Accuracy: 82.72
I0208 12:52:57.863696 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:01.153115 139825116837696 train.py:97] Step 1350, Time 0.20, Loss: 0.25, Accuracy: 92.45, Validation Loss: 0.50, Validation Accuracy: 85.20
I0208 12:53:01.156928 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:04.451045 139825116837696 train.py:97] Step 1400, Time 0.20, Loss: 0.17, Accuracy: 94.71, Validation Loss: 0.71, Validation Accuracy: 84.43
I0208 12:53:04.455388 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:07.715100 139825116837696 train.py:97] Step 1450, Time 0.20, Loss: 0.16, Accuracy: 95.01, Validation Loss: 0.69, Validation Accuracy: 85.31
I0208 12:53:07.719516 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:11.008535 139825116837696 train.py:97] Step 1500, Time 0.20, Loss: 0.16, Accuracy: 95.03, Validation Loss: 0.77, Validation Accuracy: 81.83
I0208 12:53:11.011763 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:14.270539 139825116837696 train.py:97] Step 1550, Time 0.20, Loss: 0.16, Accuracy: 94.86, Validation Loss: 0.49, Validation Accuracy: 90.01
I0208 12:53:14.272994 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:17.571232 139825116837696 train.py:97] Step 1600, Time 0.20, Loss: 0.16, Accuracy: 94.85, Validation Loss: 1.09, Validation Accuracy: 75.32
I0208 12:53:17.574685 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:20.867611 139825116837696 train.py:97] Step 1650, Time 0.20, Loss: 0.15, Accuracy: 95.35, Validation Loss: 1.08, Validation Accuracy: 75.04
I0208 12:53:20.871795 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:24.127479 139825116837696 train.py:97] Step 1700, Time 0.20, Loss: 0.14, Accuracy: 95.59, Validation Loss: 0.91, Validation Accuracy: 77.47
I0208 12:53:24.129877 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:27.426710 139825116837696 train.py:97] Step 1750, Time 0.20, Loss: 0.14, Accuracy: 95.38, Validation Loss: 1.34, Validation Accuracy: 75.65
I0208 12:53:27.429274 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:30.690855 139825116837696 train.py:97] Step 1800, Time 0.16, Loss: 0.14, Accuracy: 95.45, Validation Loss: 1.20, Validation Accuracy: 79.24
I0208 12:53:30.695176 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:33.989974 139825116837696 train.py:97] Step 1850, Time 0.20, Loss: 0.13, Accuracy: 95.81, Validation Loss: 1.15, Validation Accuracy: 76.97
I0208 12:53:33.993636 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:37.290064 139825116837696 train.py:97] Step 1900, Time 0.20, Loss: 0.12, Accuracy: 95.99, Validation Loss: 1.21, Validation Accuracy: 77.14
I0208 12:53:37.294003 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:40.552979 139825116837696 train.py:97] Step 1950, Time 0.20, Loss: 0.12, Accuracy: 95.99, Validation Loss: 1.12, Validation Accuracy: 79.13
I0208 12:53:40.556211 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:43.856110 139825116837696 train.py:97] Step 2000, Time 0.21, Loss: 0.28, Accuracy: 91.58, Validation Loss: 0.65, Validation Accuracy: 71.95
I0208 12:53:43.858630 139825116837696 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643/ckpts.
I0208 12:53:43.874636 139825116837696 train.py:121] Finished training after 2000 steps.
I0208 12:53:43.896717 139825116837696 main.py:98] Starting model evaluation...
I0208 12:53:44.218219 139825116837696 eval.py:49] 
====Results of Test set evaluation on sequential ====
I0208 12:53:44.218709 139825116837696 eval.py:50] Confusion Matrix:
[[192 138   0   0   5   3   1  30]
 [ 12 368   1   0  12   2   1   2]
 [  1   1  75   0   0   0   1   0]
 [  0   4   0 488   9   1   1   1]
 [ 44  11   0   0 269 187   7   0]
 [  1   2   0   1 270 237   1   0]
 [ 18  12   2   0  87   3 457   3]
 [ 22 289   0   0  13   0   0 173]]
I0208 12:53:44.218815 139825116837696 eval.py:51] Accuracy(balanced): 68.63
I0208 12:53:44.218899 139825116837696 eval.py:52] Accuracy(Unbalanced): 65.33
I0208 12:53:44.219091 139825116837696 eval.py:53] Accuracy(Sparse Categorical) 65.33
I0208 12:53:44.219194 139825116837696 eval.py:54] recall: ['52.03%', '92.46%', '96.15%', '96.83%', '51.93%', '46.29%', '78.52%', '34.81%']
I0208 12:53:44.219274 139825116837696 eval.py:55] precision: ['66.21%', '44.61%', '96.15%', '99.80%', '40.45%', '54.73%', '97.44%', '82.78%']
I0208 12:53:44.219351 139825116837696 eval.py:56] macro_f1_score: 70.64
I0208 12:53:44.384823 139825116837696 eval.py:60] ----Evaluation completed----
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.1.0) or chardet (5.2.0) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
wandb: 
wandb: Run history:
wandb:         macro_f1_score █▃▂▁▁▂▂
wandb:                   step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb: test_balanced_accuracy █▁▂▁▂▂▃
wandb:        test_sparse_acc █▃▁▁▁▃▃
wandb:              train_acc ▁▅▆▇▇▆▇▇▇▇▇▇▇██▇▇▇████████▇████████████▇
wandb:             train_loss █▄▃▃▂▄▃▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▂
wandb:                val_acc ▁▁▄▄▆▄▅▅▅▆▆▆▆█▇▆▅▆▆▇▆▆▇▇█▇▇▇▇▇█▆▆▆▆▇▆▆▇▆
wandb:               val_loss ▆▇█▅▂▄▂▃▂▂▂▂▂▁▂▃▄▂▃▂▃▃▂▂▁▂▁▂▂▂▁▃▃▃▄▄▄▄▃▂
wandb: 
wandb: Run summary:
wandb:         macro_f1_score 70.63864
wandb:                   step 2000
wandb: test_balanced_accuracy 68.6281
wandb:        test_sparse_acc 65.32678
wandb:              train_acc 91.57582
wandb:             train_loss 0.2844
wandb:                val_acc 71.9492
wandb:               val_loss 0.65386
wandb: 
wandb: 🚀 View run /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-51-22-365643 at: https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy/runs/cgeepejv
wandb: ️⚡ View job at https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjk3ODAzMA==/version_details/v34
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240208_125123-cgeepejv/logs
2024-02-08 12:53:51.193353: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-08 12:53:51.683651: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.1.0) or chardet (5.2.0) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
I0208 12:53:53.003672 139814761314112 tfrecords_realworldhar.py:130] [INFO] Records already exists
wandb: Currently logged in as: utsavpanchal (dl-lab-uni-stuttgart). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.3 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /home/RUS_CIP/st184584/dl-lab-23w-team10/human_activity_recognition/wandb/run-20240208_125353-nd07sn1j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906
wandb: ⭐️ View project at https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy
wandb: 🚀 View run at https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy/runs/nd07sn1j
I0208 12:53:54.333674 139814761314112 datasets.py:35] Preparing dataset har...
2024-02-08 12:53:54.445316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9802 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
I0208 12:53:56.720835 139814761314112 main.py:65] [DATASET loaded!] har
(None, 250, 6)
(None, 8)
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 bidirectional (Bidirection  (None, 250, 64)           9984      
 al)                                                             
                                                                 
 batch_normalization (Batch  (None, 250, 64)           256       
 Normalization)                                                  
                                                                 
 bidirectional_1 (Bidirecti  (None, 250, 64)           24832     
 onal)                                                           
                                                                 
 batch_normalization_1 (Bat  (None, 250, 64)           256       
 chNormalization)                                                
                                                                 
 bidirectional_2 (Bidirecti  (None, 250, 64)           24832     
 onal)                                                           
                                                                 
 batch_normalization_2 (Bat  (None, 250, 64)           256       
 chNormalization)                                                
                                                                 
 bidirectional_3 (Bidirecti  (None, 64)                24832     
 onal)                                                           
                                                                 
 batch_normalization_3 (Bat  (None, 64)                256       
 chNormalization)                                                
                                                                 
 dense (Dense)               (None, 16)                1040      
                                                                 
 dropout (Dropout)           (None, 16)                0         
                                                                 
 dense_1 (Dense)             (None, 8)                 136       
                                                                 
=================================================================
Total params: 86680 (338.59 KB)
Trainable params: 86168 (336.59 KB)
Non-trainable params: 512 (2.00 KB)
_________________________________________________________________
I0208 12:53:57.830390 139814761314112 main.py:91] Starting model training...
I0208 12:53:57.830879 139814761314112 train.py:26] Initializing from scratch. Checkpoints stored in /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts
2024-02-08 12:54:03.356986: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:432] Loaded cuDNN version 8600
2024-02-08 12:54:03.735858: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f27bb29b870 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2024-02-08 12:54:03.735909: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 2080 Ti, Compute Capability 7.5
2024-02-08 12:54:03.739789: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:255] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2024-02-08 12:54:03.842616: I ./tensorflow/compiler/jit/device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
I0208 12:54:16.396499 139814761314112 train.py:97] Step 50, Time 3.39, Loss: 1.51, Accuracy: 45.61, Validation Loss: 1.69, Validation Accuracy: 58.42
I0208 12:54:16.399919 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:54:20.535460 139814761314112 train.py:97] Step 100, Time 0.22, Loss: 0.84, Accuracy: 71.86, Validation Loss: 1.10, Validation Accuracy: 65.49
I0208 12:54:20.539423 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:54:24.564239 139814761314112 train.py:97] Step 150, Time 0.22, Loss: 0.56, Accuracy: 82.76, Validation Loss: 0.89, Validation Accuracy: 68.03
I0208 12:54:24.568604 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:54:28.642899 139814761314112 train.py:97] Step 200, Time 0.22, Loss: 0.43, Accuracy: 87.13, Validation Loss: 0.73, Validation Accuracy: 73.72
I0208 12:54:28.647633 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:54:32.692570 139814761314112 train.py:97] Step 250, Time 0.22, Loss: 0.38, Accuracy: 88.73, Validation Loss: 0.96, Validation Accuracy: 69.13
I0208 12:54:32.696339 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:54:36.741693 139814761314112 train.py:97] Step 300, Time 0.22, Loss: 0.34, Accuracy: 89.66, Validation Loss: 1.04, Validation Accuracy: 73.27
I0208 12:54:36.744079 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:54:40.822336 139814761314112 train.py:97] Step 350, Time 0.22, Loss: 0.31, Accuracy: 90.92, Validation Loss: 1.18, Validation Accuracy: 73.66
I0208 12:54:40.825971 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:54:44.856312 139814761314112 train.py:97] Step 400, Time 0.22, Loss: 0.30, Accuracy: 90.92, Validation Loss: 0.62, Validation Accuracy: 84.70
I0208 12:54:44.860023 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:54:48.940374 139814761314112 train.py:97] Step 450, Time 0.22, Loss: 0.29, Accuracy: 91.26, Validation Loss: 0.73, Validation Accuracy: 74.32
I0208 12:54:48.944045 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:54:53.008423 139814761314112 train.py:97] Step 500, Time 0.22, Loss: 0.27, Accuracy: 92.02, Validation Loss: 1.11, Validation Accuracy: 66.59
I0208 12:54:53.012243 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:54:57.067587 139814761314112 train.py:97] Step 550, Time 0.22, Loss: 0.24, Accuracy: 92.85, Validation Loss: 1.08, Validation Accuracy: 70.73
I0208 12:54:57.070105 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:01.163986 139814761314112 train.py:97] Step 600, Time 0.21, Loss: 0.22, Accuracy: 93.64, Validation Loss: 0.97, Validation Accuracy: 72.72
I0208 12:55:01.168414 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:05.227989 139814761314112 train.py:97] Step 650, Time 0.22, Loss: 0.21, Accuracy: 93.53, Validation Loss: 1.02, Validation Accuracy: 72.72
I0208 12:55:05.231723 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:09.327348 139814761314112 train.py:97] Step 700, Time 0.22, Loss: 0.21, Accuracy: 93.82, Validation Loss: 0.98, Validation Accuracy: 70.73
I0208 12:55:09.332818 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:13.427766 139814761314112 train.py:97] Step 750, Time 0.22, Loss: 0.20, Accuracy: 94.18, Validation Loss: 1.29, Validation Accuracy: 70.73
I0208 12:55:13.432147 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:17.480137 139814761314112 train.py:97] Step 800, Time 0.22, Loss: 0.19, Accuracy: 94.11, Validation Loss: 1.11, Validation Accuracy: 72.06
I0208 12:55:17.484121 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:21.583233 139814761314112 train.py:97] Step 850, Time 0.22, Loss: 0.19, Accuracy: 94.27, Validation Loss: 1.30, Validation Accuracy: 76.31
I0208 12:55:21.586827 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:25.626583 139814761314112 train.py:97] Step 900, Time 0.19, Loss: 0.18, Accuracy: 94.49, Validation Loss: 1.38, Validation Accuracy: 73.16
I0208 12:55:25.630661 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:29.742841 139814761314112 train.py:97] Step 950, Time 0.22, Loss: 0.17, Accuracy: 95.03, Validation Loss: 1.51, Validation Accuracy: 67.09
I0208 12:55:29.746392 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:33.825148 139814761314112 train.py:97] Step 1000, Time 0.22, Loss: 0.16, Accuracy: 95.05, Validation Loss: 1.44, Validation Accuracy: 67.53
I0208 12:55:33.828812 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:37.891824 139814761314112 train.py:97] Step 1050, Time 0.22, Loss: 0.16, Accuracy: 95.15, Validation Loss: 1.58, Validation Accuracy: 61.73
I0208 12:55:37.896654 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:41.997437 139814761314112 train.py:97] Step 1100, Time 0.22, Loss: 0.15, Accuracy: 95.45, Validation Loss: 1.41, Validation Accuracy: 69.46
I0208 12:55:42.002194 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:46.055168 139814761314112 train.py:97] Step 1150, Time 0.22, Loss: 0.17, Accuracy: 94.92, Validation Loss: 1.66, Validation Accuracy: 64.83
I0208 12:55:46.058674 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:50.111164 139814761314112 train.py:97] Step 1200, Time 0.22, Loss: 0.15, Accuracy: 95.63, Validation Loss: 1.36, Validation Accuracy: 74.38
I0208 12:55:50.114635 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:54.200628 139814761314112 train.py:97] Step 1250, Time 0.22, Loss: 0.15, Accuracy: 95.03, Validation Loss: 1.33, Validation Accuracy: 75.92
I0208 12:55:54.203914 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:55:58.239110 139814761314112 train.py:97] Step 1300, Time 0.22, Loss: 0.13, Accuracy: 95.82, Validation Loss: 1.50, Validation Accuracy: 74.82
I0208 12:55:58.242764 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:02.337745 139814761314112 train.py:97] Step 1350, Time 0.22, Loss: 0.14, Accuracy: 95.79, Validation Loss: 1.74, Validation Accuracy: 73.16
I0208 12:56:02.341710 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:06.416181 139814761314112 train.py:97] Step 1400, Time 0.22, Loss: 0.15, Accuracy: 95.51, Validation Loss: 1.52, Validation Accuracy: 73.50
I0208 12:56:06.421077 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:10.482508 139814761314112 train.py:97] Step 1450, Time 0.22, Loss: 0.14, Accuracy: 95.64, Validation Loss: 1.49, Validation Accuracy: 78.46
I0208 12:56:10.486401 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:14.594521 139814761314112 train.py:97] Step 1500, Time 0.23, Loss: 0.13, Accuracy: 95.79, Validation Loss: 1.75, Validation Accuracy: 77.42
I0208 12:56:14.598347 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:18.662116 139814761314112 train.py:97] Step 1550, Time 0.21, Loss: 0.13, Accuracy: 95.96, Validation Loss: 2.26, Validation Accuracy: 71.89
I0208 12:56:18.666543 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:22.764125 139814761314112 train.py:97] Step 1600, Time 0.22, Loss: 0.12, Accuracy: 96.23, Validation Loss: 1.70, Validation Accuracy: 74.65
I0208 12:56:22.769120 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:26.859694 139814761314112 train.py:97] Step 1650, Time 0.23, Loss: 0.13, Accuracy: 95.88, Validation Loss: 1.71, Validation Accuracy: 74.43
I0208 12:56:26.863170 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:30.913099 139814761314112 train.py:97] Step 1700, Time 0.22, Loss: 0.12, Accuracy: 96.04, Validation Loss: 1.57, Validation Accuracy: 73.77
I0208 12:56:30.917330 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:35.000188 139814761314112 train.py:97] Step 1750, Time 0.22, Loss: 0.12, Accuracy: 96.30, Validation Loss: 1.64, Validation Accuracy: 77.19
I0208 12:56:35.003643 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:39.047345 139814761314112 train.py:97] Step 1800, Time 0.18, Loss: 0.11, Accuracy: 96.39, Validation Loss: 1.96, Validation Accuracy: 74.38
I0208 12:56:39.052672 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:43.151588 139814761314112 train.py:97] Step 1850, Time 0.22, Loss: 0.10, Accuracy: 96.73, Validation Loss: 2.13, Validation Accuracy: 76.92
I0208 12:56:43.155176 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:47.254588 139814761314112 train.py:97] Step 1900, Time 0.22, Loss: 0.10, Accuracy: 96.66, Validation Loss: 1.85, Validation Accuracy: 71.40
I0208 12:56:47.256991 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:51.306766 139814761314112 train.py:97] Step 1950, Time 0.22, Loss: 0.11, Accuracy: 96.33, Validation Loss: 1.84, Validation Accuracy: 77.03
I0208 12:56:51.310272 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:55.406255 139814761314112 train.py:97] Step 2000, Time 0.22, Loss: 0.10, Accuracy: 96.69, Validation Loss: 2.10, Validation Accuracy: 74.65
I0208 12:56:55.411217 139814761314112 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906/ckpts.
I0208 12:56:55.435154 139814761314112 train.py:121] Finished training after 2000 steps.
I0208 12:56:55.461972 139814761314112 main.py:98] Starting model evaluation...
I0208 12:56:55.894195 139814761314112 eval.py:49] 
====Results of Test set evaluation on sequential ====
I0208 12:56:55.894691 139814761314112 eval.py:50] Confusion Matrix:
[[329  35   0   0   0   5   0   0]
 [  0 387   0   0   8   3   0   0]
 [  1   0  76   0   0   0   1   0]
 [  1   0   0 492   3   8   0   0]
 [  4  35   0   2  71 375  20  11]
 [  0   0   0   1 251 259   1   0]
 [  9   8   1   1  79  11 473   0]
 [  7 237   0   0   6   0   0 247]]
I0208 12:56:55.894806 139814761314112 eval.py:51] Accuracy(balanced): 72.09
I0208 12:56:55.894897 139814761314112 eval.py:52] Accuracy(Unbalanced): 67.50
I0208 12:56:55.895091 139814761314112 eval.py:53] Accuracy(Sparse Categorical) 67.50
I0208 12:56:55.895200 139814761314112 eval.py:54] recall: ['89.16%', '97.24%', '97.44%', '97.62%', '13.71%', '50.59%', '81.27%', '49.70%']
I0208 12:56:55.895286 139814761314112 eval.py:55] precision: ['93.73%', '55.13%', '98.70%', '99.19%', '16.99%', '39.18%', '95.56%', '95.74%']
I0208 12:56:55.895367 139814761314112 eval.py:56] macro_f1_score: 73.17
I0208 12:56:56.059689 139814761314112 eval.py:60] ----Evaluation completed----
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.1.0) or chardet (5.2.0) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
wandb: - 0.006 MB of 0.006 MB uploadedwandb: \ 0.006 MB of 0.006 MB uploadedwandb: | 0.006 MB of 0.006 MB uploadedwandb: / 0.006 MB of 0.006 MB uploadedwandb: 
wandb: Run history:
wandb:         macro_f1_score █▃▂▁▁▁▂
wandb:                   step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb: test_balanced_accuracy █▂▁▁▁▂▂
wandb:        test_sparse_acc █▃▁▂▁▂▂
wandb:              train_acc ▁▅▆▇▇▇▇▇▇▇▇█████████████████████████████
wandb:             train_loss █▅▃▃▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                val_acc ▁▃▄▅▄▅▅█▅▃▄▅▅▄▄▅▆▅▃▃▂▄▃▅▆▅▅▅▆▆▅▅▅▅▆▅▆▄▆▅
wandb:               val_loss ▆▃▂▁▂▃▃▁▁▃▃▂▃▃▄▃▄▄▅▄▅▄▅▄▄▅▆▅▅▆█▆▆▅▅▇▇▆▆▇
wandb: 
wandb: Run summary:
wandb:         macro_f1_score 73.16672
wandb:                   step 2000
wandb: test_balanced_accuracy 72.08915
wandb:        test_sparse_acc 67.49566
wandb:              train_acc 96.69297
wandb:             train_loss 0.09686
wandb:                val_acc 74.65489
wandb:               val_loss 2.10137
wandb: 
wandb: 🚀 View run /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-53-52-998906 at: https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy/runs/nd07sn1j
wandb: ️⚡ View job at https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjk3ODAzMA==/version_details/v34
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240208_125353-nd07sn1j/logs
2024-02-08 12:57:03.700660: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-08 12:57:04.194399: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.1.0) or chardet (5.2.0) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
I0208 12:57:05.516233 140375699154752 tfrecords_realworldhar.py:130] [INFO] Records already exists
wandb: Currently logged in as: utsavpanchal (dl-lab-uni-stuttgart). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.3 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /home/RUS_CIP/st184584/dl-lab-23w-team10/human_activity_recognition/wandb/run-20240208_125706-fflnl84f
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241
wandb: ⭐️ View project at https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy
wandb: 🚀 View run at https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy/runs/fflnl84f
I0208 12:57:06.908153 140375699154752 datasets.py:35] Preparing dataset har...
2024-02-08 12:57:07.030778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9802 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
I0208 12:57:09.400604 140375699154752 main.py:65] [DATASET loaded!] har
(None, 250, 6)
(None, 8)
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru (GRU)                   (None, 250, 32)           3840      
                                                                 
 batch_normalization (Batch  (None, 250, 32)           128       
 Normalization)                                                  
                                                                 
 gru_1 (GRU)                 (None, 250, 32)           6336      
                                                                 
 batch_normalization_1 (Bat  (None, 250, 32)           128       
 chNormalization)                                                
                                                                 
 gru_2 (GRU)                 (None, 250, 32)           6336      
                                                                 
 batch_normalization_2 (Bat  (None, 250, 32)           128       
 chNormalization)                                                
                                                                 
 gru_3 (GRU)                 (None, 32)                6336      
                                                                 
 batch_normalization_3 (Bat  (None, 32)                128       
 chNormalization)                                                
                                                                 
 dense (Dense)               (None, 16)                528       
                                                                 
 dropout (Dropout)           (None, 16)                0         
                                                                 
 dense_1 (Dense)             (None, 8)                 136       
                                                                 
=================================================================
Total params: 24024 (93.84 KB)
Trainable params: 23768 (92.84 KB)
Non-trainable params: 256 (1.00 KB)
_________________________________________________________________
I0208 12:57:09.874656 140375699154752 main.py:91] Starting model training...
I0208 12:57:09.875163 140375699154752 train.py:26] Initializing from scratch. Checkpoints stored in /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts
2024-02-08 12:57:12.865707: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:432] Loaded cuDNN version 8600
2024-02-08 12:57:13.073124: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7faa49b6dac0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2024-02-08 12:57:13.073198: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 2080 Ti, Compute Capability 7.5
2024-02-08 12:57:13.076680: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:255] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2024-02-08 12:57:13.175074: I ./tensorflow/compiler/jit/device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
I0208 12:57:19.816855 140375699154752 train.py:97] Step 50, Time 1.69, Loss: 1.99, Accuracy: 27.07, Validation Loss: 1.88, Validation Accuracy: 27.39
I0208 12:57:19.819982 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:21.820402 140375699154752 train.py:97] Step 100, Time 0.12, Loss: 1.54, Accuracy: 42.44, Validation Loss: 1.99, Validation Accuracy: 14.08
I0208 12:57:21.825402 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:23.787502 140375699154752 train.py:97] Step 150, Time 0.12, Loss: 1.31, Accuracy: 52.81, Validation Loss: 1.89, Validation Accuracy: 15.63
I0208 12:57:23.791839 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:25.709957 140375699154752 train.py:97] Step 200, Time 0.12, Loss: 1.09, Accuracy: 62.48, Validation Loss: 1.44, Validation Accuracy: 45.39
I0208 12:57:25.713688 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:27.650037 140375699154752 train.py:97] Step 250, Time 0.13, Loss: 0.87, Accuracy: 70.92, Validation Loss: 0.93, Validation Accuracy: 68.30
I0208 12:57:27.653498 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:29.580017 140375699154752 train.py:97] Step 300, Time 0.12, Loss: 0.70, Accuracy: 78.77, Validation Loss: 1.24, Validation Accuracy: 62.62
I0208 12:57:29.583733 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:31.528785 140375699154752 train.py:97] Step 350, Time 0.12, Loss: 0.58, Accuracy: 82.80, Validation Loss: 1.40, Validation Accuracy: 58.86
I0208 12:57:31.532066 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:33.443856 140375699154752 train.py:97] Step 400, Time 0.12, Loss: 0.49, Accuracy: 85.35, Validation Loss: 1.64, Validation Accuracy: 56.16
I0208 12:57:33.447370 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:35.372005 140375699154752 train.py:97] Step 450, Time 0.12, Loss: 0.44, Accuracy: 86.39, Validation Loss: 1.35, Validation Accuracy: 64.27
I0208 12:57:35.376772 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:37.301905 140375699154752 train.py:97] Step 500, Time 0.12, Loss: 0.41, Accuracy: 87.20, Validation Loss: 1.11, Validation Accuracy: 68.75
I0208 12:57:37.305504 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:39.226775 140375699154752 train.py:97] Step 550, Time 0.12, Loss: 0.37, Accuracy: 88.27, Validation Loss: 0.80, Validation Accuracy: 73.16
I0208 12:57:39.230797 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:41.171254 140375699154752 train.py:97] Step 600, Time 0.12, Loss: 0.35, Accuracy: 88.91, Validation Loss: 1.18, Validation Accuracy: 64.99
I0208 12:57:41.175115 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:43.093560 140375699154752 train.py:97] Step 650, Time 0.12, Loss: 0.32, Accuracy: 89.66, Validation Loss: 1.31, Validation Accuracy: 63.39
I0208 12:57:43.097447 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:45.018332 140375699154752 train.py:97] Step 700, Time 0.11, Loss: 0.32, Accuracy: 89.49, Validation Loss: 1.15, Validation Accuracy: 71.40
I0208 12:57:45.021874 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:46.957642 140375699154752 train.py:97] Step 750, Time 0.12, Loss: 0.30, Accuracy: 90.53, Validation Loss: 1.33, Validation Accuracy: 63.67
I0208 12:57:46.960452 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:48.877303 140375699154752 train.py:97] Step 800, Time 0.11, Loss: 0.28, Accuracy: 90.96, Validation Loss: 0.97, Validation Accuracy: 73.61
I0208 12:57:48.881144 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:50.826537 140375699154752 train.py:97] Step 850, Time 0.13, Loss: 0.26, Accuracy: 91.62, Validation Loss: 2.30, Validation Accuracy: 51.35
I0208 12:57:50.830126 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:52.735713 140375699154752 train.py:97] Step 900, Time 0.11, Loss: 0.26, Accuracy: 91.26, Validation Loss: 1.89, Validation Accuracy: 53.40
I0208 12:57:52.739166 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:54.678428 140375699154752 train.py:97] Step 950, Time 0.12, Loss: 0.25, Accuracy: 91.71, Validation Loss: 1.04, Validation Accuracy: 71.84
I0208 12:57:54.682162 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:56.625370 140375699154752 train.py:97] Step 1000, Time 0.13, Loss: 0.25, Accuracy: 92.21, Validation Loss: 1.85, Validation Accuracy: 57.54
I0208 12:57:56.629030 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:57:58.548546 140375699154752 train.py:97] Step 1050, Time 0.11, Loss: 0.23, Accuracy: 92.66, Validation Loss: 1.84, Validation Accuracy: 60.46
I0208 12:57:58.552246 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:00.458206 140375699154752 train.py:97] Step 1100, Time 0.12, Loss: 0.22, Accuracy: 93.07, Validation Loss: 1.38, Validation Accuracy: 64.22
I0208 12:58:00.461894 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:02.392752 140375699154752 train.py:97] Step 1150, Time 0.11, Loss: 0.24, Accuracy: 92.87, Validation Loss: 1.95, Validation Accuracy: 61.24
I0208 12:58:02.396279 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:04.321207 140375699154752 train.py:97] Step 1200, Time 0.12, Loss: 0.21, Accuracy: 93.43, Validation Loss: 1.81, Validation Accuracy: 64.22
I0208 12:58:04.326081 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:06.262685 140375699154752 train.py:97] Step 1250, Time 0.12, Loss: 0.21, Accuracy: 93.48, Validation Loss: 1.86, Validation Accuracy: 60.08
I0208 12:58:06.266186 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:08.182482 140375699154752 train.py:97] Step 1300, Time 0.12, Loss: 0.20, Accuracy: 93.53, Validation Loss: 1.98, Validation Accuracy: 61.84
I0208 12:58:08.187771 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:10.118643 140375699154752 train.py:97] Step 1350, Time 0.12, Loss: 0.18, Accuracy: 94.04, Validation Loss: 2.36, Validation Accuracy: 60.46
I0208 12:58:10.122166 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:12.071874 140375699154752 train.py:97] Step 1400, Time 0.12, Loss: 0.19, Accuracy: 93.96, Validation Loss: 2.65, Validation Accuracy: 54.94
I0208 12:58:12.076180 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:13.993912 140375699154752 train.py:97] Step 1450, Time 0.12, Loss: 0.18, Accuracy: 93.84, Validation Loss: 2.46, Validation Accuracy: 58.97
I0208 12:58:13.996301 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:15.922132 140375699154752 train.py:97] Step 1500, Time 0.12, Loss: 0.18, Accuracy: 94.06, Validation Loss: 1.69, Validation Accuracy: 67.03
I0208 12:58:15.925768 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:17.851423 140375699154752 train.py:97] Step 1550, Time 0.12, Loss: 0.17, Accuracy: 94.15, Validation Loss: 2.84, Validation Accuracy: 55.11
I0208 12:58:17.855316 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:19.798465 140375699154752 train.py:97] Step 1600, Time 0.12, Loss: 0.17, Accuracy: 94.12, Validation Loss: 2.03, Validation Accuracy: 65.82
I0208 12:58:19.802045 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:21.762850 140375699154752 train.py:97] Step 1650, Time 0.12, Loss: 0.17, Accuracy: 94.27, Validation Loss: 2.51, Validation Accuracy: 57.87
I0208 12:58:21.765421 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:23.717588 140375699154752 train.py:97] Step 1700, Time 0.12, Loss: 0.17, Accuracy: 94.32, Validation Loss: 1.94, Validation Accuracy: 68.25
I0208 12:58:23.722378 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:25.653810 140375699154752 train.py:97] Step 1750, Time 0.12, Loss: 0.17, Accuracy: 94.38, Validation Loss: 2.77, Validation Accuracy: 53.89
I0208 12:58:25.657864 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:27.589692 140375699154752 train.py:97] Step 1800, Time 0.11, Loss: 0.16, Accuracy: 94.42, Validation Loss: 2.12, Validation Accuracy: 65.65
I0208 12:58:27.594135 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:29.521163 140375699154752 train.py:97] Step 1850, Time 0.12, Loss: 0.16, Accuracy: 94.47, Validation Loss: 2.70, Validation Accuracy: 55.60
I0208 12:58:29.524737 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:31.463896 140375699154752 train.py:97] Step 1900, Time 0.12, Loss: 0.15, Accuracy: 94.63, Validation Loss: 2.72, Validation Accuracy: 56.16
I0208 12:58:31.468071 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:33.418793 140375699154752 train.py:97] Step 1950, Time 0.12, Loss: 0.16, Accuracy: 94.56, Validation Loss: 1.80, Validation Accuracy: 64.61
I0208 12:58:33.422211 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:35.387050 140375699154752 train.py:97] Step 2000, Time 0.12, Loss: 0.15, Accuracy: 94.79, Validation Loss: 2.19, Validation Accuracy: 64.94
I0208 12:58:35.390556 140375699154752 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241/ckpts.
I0208 12:58:35.407993 140375699154752 train.py:121] Finished training after 2000 steps.
I0208 12:58:35.430472 140375699154752 main.py:98] Starting model evaluation...
I0208 12:58:35.712894 140375699154752 eval.py:49] 
====Results of Test set evaluation on sequential ====
I0208 12:58:35.713434 140375699154752 eval.py:50] Confusion Matrix:
[[320  39   0   0   2   5   3   0]
 [  2 375   1   0  11   4   5   0]
 [  1   0  76   0   0   0   1   0]
 [  0   0   0 489   3  12   0   0]
 [  0   0   0   0 173 268   4  73]
 [  0   0   0   0 258 249   0   5]
 [  6   0   1   1  71  22 479   2]
 [  0 259   0   0   5   2   0 231]]
I0208 12:58:35.713558 140375699154752 eval.py:51] Accuracy(balanced): 73.28
I0208 12:58:35.713655 140375699154752 eval.py:52] Accuracy(Unbalanced): 69.17
I0208 12:58:35.713876 140375699154752 eval.py:53] Accuracy(Sparse Categorical) 69.17
I0208 12:58:35.714023 140375699154752 eval.py:54] recall: ['86.72%', '94.22%', '97.44%', '97.02%', '33.40%', '48.63%', '82.30%', '46.48%']
I0208 12:58:35.714116 140375699154752 eval.py:55] precision: ['97.26%', '55.72%', '97.44%', '99.80%', '33.08%', '44.31%', '97.36%', '74.28%']
I0208 12:58:35.714226 140375699154752 eval.py:56] macro_f1_score: 74.08
I0208 12:58:35.895699 140375699154752 eval.py:60] ----Evaluation completed----
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.1.0) or chardet (5.2.0) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
wandb: 
wandb: Run history:
wandb:         macro_f1_score █▂▁▂▁▁▁
wandb:                   step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb: test_balanced_accuracy █▂▁▂▂▂▂
wandb:        test_sparse_acc █▃▁▂▂▂▃
wandb:              train_acc ▁▃▄▅▆▆▇▇▇▇▇▇▇▇██████████████████████████
wandb:             train_loss █▆▅▅▄▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                val_acc ▃▁▁▅▇▇▆▆▇▇█▇▇█▇█▅▆█▆▆▇▇▇▆▇▆▆▆▇▆▇▆▇▆▇▆▆▇▇
wandb:               val_loss ▅▅▅▃▁▃▃▄▃▂▁▂▃▂▃▂▆▅▂▅▅▃▅▄▅▅▆▇▇▄█▅▇▅█▆██▄▆
wandb: 
wandb: Run summary:
wandb:         macro_f1_score 74.08163
wandb:                   step 2000
wandb: test_balanced_accuracy 73.27668
wandb:        test_sparse_acc 69.17293
wandb:              train_acc 94.78522
wandb:             train_loss 0.15227
wandb:                val_acc 64.9365
wandb:               val_loss 2.18788
wandb: 
wandb: 🚀 View run /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-57-05-511241 at: https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy/runs/fflnl84f
wandb: ️⚡ View job at https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjk3ODAzMA==/version_details/v34
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240208_125706-fflnl84f/logs
2024-02-08 12:58:42.238508: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-08 12:58:42.745608: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.1.0) or chardet (5.2.0) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
I0208 12:58:44.085120 140125541349184 tfrecords_realworldhar.py:130] [INFO] Records already exists
wandb: Currently logged in as: utsavpanchal (dl-lab-uni-stuttgart). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.3 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /home/RUS_CIP/st184584/dl-lab-23w-team10/human_activity_recognition/wandb/run-20240208_125844-h36txdhq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392
wandb: ⭐️ View project at https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy
wandb: 🚀 View run at https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy/runs/h36txdhq
I0208 12:58:45.507782 140125541349184 datasets.py:35] Preparing dataset har...
2024-02-08 12:58:45.625350: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 9802 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:01:00.0, compute capability: 7.5
I0208 12:58:48.052770 140125541349184 main.py:65] [DATASET loaded!] har
(None, 250, 6)
(None, 8)
Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv1d (Conv1D)             (None, 248, 64)           1216      
                                                                 
 batch_normalization (Batch  (None, 248, 64)           256       
 Normalization)                                                  
                                                                 
 dropout (Dropout)           (None, 248, 64)           0         
                                                                 
 conv1d_1 (Conv1D)           (None, 246, 64)           12352     
                                                                 
 batch_normalization_1 (Bat  (None, 246, 64)           256       
 chNormalization)                                                
                                                                 
 dropout_1 (Dropout)         (None, 246, 64)           0         
                                                                 
 global_max_pooling1d (Glob  (None, 64)                0         
 alMaxPooling1D)                                                 
                                                                 
 dense (Dense)               (None, 16)                1040      
                                                                 
 dropout_2 (Dropout)         (None, 16)                0         
                                                                 
 dense_1 (Dense)             (None, 8)                 136       
                                                                 
=================================================================
Total params: 15256 (59.59 KB)
Trainable params: 15000 (58.59 KB)
Non-trainable params: 256 (1.00 KB)
_________________________________________________________________
I0208 12:58:48.119195 140125541349184 main.py:91] Starting model training...
I0208 12:58:48.119672 140125541349184 train.py:26] Initializing from scratch. Checkpoints stored in /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts
2024-02-08 12:58:48.904311: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:432] Loaded cuDNN version 8600
2024-02-08 12:58:49.195507: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f6cf9e154a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2024-02-08 12:58:49.195553: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 2080 Ti, Compute Capability 7.5
2024-02-08 12:58:49.198762: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:255] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2024-02-08 12:58:49.297926: I ./tensorflow/compiler/jit/device_compiler.h:186] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
I0208 12:58:51.438378 140125541349184 train.py:97] Step 50, Time 0.25, Loss: 2.89, Accuracy: 36.94, Validation Loss: 1.84, Validation Accuracy: 10.38
I0208 12:58:51.442000 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:52.082240 140125541349184 train.py:97] Step 100, Time 0.07, Loss: 1.17, Accuracy: 56.09, Validation Loss: 1.64, Validation Accuracy: 53.06
I0208 12:58:52.084624 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:52.721571 140125541349184 train.py:97] Step 150, Time 0.07, Loss: 1.00, Accuracy: 63.45, Validation Loss: 1.46, Validation Accuracy: 65.05
I0208 12:58:52.724165 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:53.261453 140125541349184 train.py:97] Step 200, Time 0.06, Loss: 0.89, Accuracy: 67.64, Validation Loss: 1.27, Validation Accuracy: 69.46
I0208 12:58:53.265243 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:53.808249 140125541349184 train.py:97] Step 250, Time 0.07, Loss: 0.80, Accuracy: 71.28, Validation Loss: 1.06, Validation Accuracy: 79.96
I0208 12:58:53.810831 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:54.364027 140125541349184 train.py:97] Step 300, Time 0.08, Loss: 0.73, Accuracy: 74.26, Validation Loss: 0.91, Validation Accuracy: 85.81
I0208 12:58:54.366491 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:54.938889 140125541349184 train.py:97] Step 350, Time 0.08, Loss: 0.68, Accuracy: 76.55, Validation Loss: 0.78, Validation Accuracy: 87.13
I0208 12:58:54.943315 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:55.485828 140125541349184 train.py:97] Step 400, Time 0.08, Loss: 0.63, Accuracy: 78.41, Validation Loss: 0.70, Validation Accuracy: 88.85
I0208 12:58:55.488730 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:56.038100 140125541349184 train.py:97] Step 450, Time 0.08, Loss: 0.60, Accuracy: 79.53, Validation Loss: 0.64, Validation Accuracy: 89.01
I0208 12:58:56.040688 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:56.585875 140125541349184 train.py:97] Step 500, Time 0.07, Loss: 0.57, Accuracy: 80.48, Validation Loss: 0.58, Validation Accuracy: 90.34
I0208 12:58:56.588622 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:57.128177 140125541349184 train.py:97] Step 550, Time 0.07, Loss: 0.55, Accuracy: 81.12, Validation Loss: 0.58, Validation Accuracy: 87.96
I0208 12:58:57.130947 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:57.689295 140125541349184 train.py:97] Step 600, Time 0.08, Loss: 0.52, Accuracy: 82.22, Validation Loss: 0.52, Validation Accuracy: 90.45
I0208 12:58:57.691991 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:58.235359 140125541349184 train.py:97] Step 650, Time 0.08, Loss: 0.50, Accuracy: 82.60, Validation Loss: 0.49, Validation Accuracy: 91.94
I0208 12:58:58.237998 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:58.791653 140125541349184 train.py:97] Step 700, Time 0.08, Loss: 0.48, Accuracy: 83.01, Validation Loss: 0.48, Validation Accuracy: 91.94
I0208 12:58:58.794316 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:59.337981 140125541349184 train.py:97] Step 750, Time 0.07, Loss: 0.47, Accuracy: 83.40, Validation Loss: 0.46, Validation Accuracy: 92.32
I0208 12:58:59.341257 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:58:59.893979 140125541349184 train.py:97] Step 800, Time 0.08, Loss: 0.45, Accuracy: 84.02, Validation Loss: 0.46, Validation Accuracy: 91.66
I0208 12:58:59.896829 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:00.443337 140125541349184 train.py:97] Step 850, Time 0.07, Loss: 0.44, Accuracy: 84.58, Validation Loss: 0.44, Validation Accuracy: 91.99
I0208 12:59:00.446556 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:00.979980 140125541349184 train.py:97] Step 900, Time 0.06, Loss: 0.44, Accuracy: 84.35, Validation Loss: 0.43, Validation Accuracy: 92.16
I0208 12:59:00.983521 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:01.529495 140125541349184 train.py:97] Step 950, Time 0.07, Loss: 0.42, Accuracy: 85.31, Validation Loss: 0.42, Validation Accuracy: 92.21
I0208 12:59:01.532166 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:02.074805 140125541349184 train.py:97] Step 1000, Time 0.07, Loss: 0.40, Accuracy: 85.82, Validation Loss: 0.44, Validation Accuracy: 91.33
I0208 12:59:02.077480 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:02.623957 140125541349184 train.py:97] Step 1050, Time 0.08, Loss: 0.39, Accuracy: 86.21, Validation Loss: 0.41, Validation Accuracy: 91.99
I0208 12:59:02.627747 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:03.172675 140125541349184 train.py:97] Step 1100, Time 0.07, Loss: 0.39, Accuracy: 86.10, Validation Loss: 0.41, Validation Accuracy: 91.83
I0208 12:59:03.175339 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:03.721509 140125541349184 train.py:97] Step 1150, Time 0.07, Loss: 0.38, Accuracy: 86.47, Validation Loss: 0.42, Validation Accuracy: 91.50
I0208 12:59:03.724111 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:04.266398 140125541349184 train.py:97] Step 1200, Time 0.07, Loss: 0.37, Accuracy: 87.04, Validation Loss: 0.39, Validation Accuracy: 91.94
I0208 12:59:04.269688 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:04.814260 140125541349184 train.py:97] Step 1250, Time 0.07, Loss: 0.36, Accuracy: 87.46, Validation Loss: 0.38, Validation Accuracy: 91.72
I0208 12:59:04.818081 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:05.358464 140125541349184 train.py:97] Step 1300, Time 0.07, Loss: 0.35, Accuracy: 87.76, Validation Loss: 0.38, Validation Accuracy: 91.94
I0208 12:59:05.362623 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:05.912126 140125541349184 train.py:97] Step 1350, Time 0.07, Loss: 0.34, Accuracy: 88.11, Validation Loss: 0.42, Validation Accuracy: 90.12
I0208 12:59:05.914936 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:06.463902 140125541349184 train.py:97] Step 1400, Time 0.07, Loss: 0.33, Accuracy: 88.71, Validation Loss: 0.41, Validation Accuracy: 90.78
I0208 12:59:06.466430 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:07.009339 140125541349184 train.py:97] Step 1450, Time 0.08, Loss: 0.33, Accuracy: 88.44, Validation Loss: 0.43, Validation Accuracy: 89.56
I0208 12:59:07.011922 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:07.555602 140125541349184 train.py:97] Step 1500, Time 0.07, Loss: 0.32, Accuracy: 88.92, Validation Loss: 0.38, Validation Accuracy: 90.94
I0208 12:59:07.558358 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:08.095623 140125541349184 train.py:97] Step 1550, Time 0.07, Loss: 0.32, Accuracy: 89.08, Validation Loss: 0.40, Validation Accuracy: 89.90
I0208 12:59:08.098393 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:08.635863 140125541349184 train.py:97] Step 1600, Time 0.07, Loss: 0.31, Accuracy: 89.31, Validation Loss: 0.36, Validation Accuracy: 91.66
I0208 12:59:08.638326 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:09.185284 140125541349184 train.py:97] Step 1650, Time 0.07, Loss: 0.30, Accuracy: 89.73, Validation Loss: 0.37, Validation Accuracy: 91.05
I0208 12:59:09.188943 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:09.738138 140125541349184 train.py:97] Step 1700, Time 0.08, Loss: 0.31, Accuracy: 89.53, Validation Loss: 0.37, Validation Accuracy: 90.61
I0208 12:59:09.741384 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:10.295299 140125541349184 train.py:97] Step 1750, Time 0.08, Loss: 0.29, Accuracy: 89.97, Validation Loss: 0.38, Validation Accuracy: 90.67
I0208 12:59:10.299163 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:10.843171 140125541349184 train.py:97] Step 1800, Time 0.07, Loss: 0.30, Accuracy: 89.79, Validation Loss: 0.38, Validation Accuracy: 90.50
I0208 12:59:10.845490 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:11.397052 140125541349184 train.py:97] Step 1850, Time 0.08, Loss: 0.29, Accuracy: 90.40, Validation Loss: 0.38, Validation Accuracy: 90.06
I0208 12:59:11.399826 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:11.961815 140125541349184 train.py:97] Step 1900, Time 0.09, Loss: 0.28, Accuracy: 90.59, Validation Loss: 0.37, Validation Accuracy: 89.73
I0208 12:59:11.964541 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:12.502694 140125541349184 train.py:97] Step 1950, Time 0.07, Loss: 0.28, Accuracy: 90.77, Validation Loss: 0.34, Validation Accuracy: 90.78
I0208 12:59:12.505572 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:13.041562 140125541349184 train.py:97] Step 2000, Time 0.06, Loss: 0.28, Accuracy: 90.41, Validation Loss: 0.35, Validation Accuracy: 90.61
I0208 12:59:13.044642 140125541349184 train.py:117] Saving checkpoint to /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392/ckpts.
I0208 12:59:13.062080 140125541349184 train.py:121] Finished training after 2000 steps.
I0208 12:59:13.087620 140125541349184 main.py:98] Starting model evaluation...
I0208 12:59:13.307750 140125541349184 eval.py:49] 
====Results of Test set evaluation on sequential ====
I0208 12:59:13.308247 140125541349184 eval.py:50] Confusion Matrix:
[[345   5   0   0   0   3   0  16]
 [  2 377   0   0  12   0   3   4]
 [  2   0  72   0   0   0   4   0]
 [  0   1   0 489   7   7   0   0]
 [  0   2   0   0  14 492   0  10]
 [  0   3   0   0 239 268   0   2]
 [ 13   2   1  10  67   1 469  19]
 [ 13 150   0   0   4   0   0 330]]
I0208 12:59:13.308354 140125541349184 eval.py:51] Accuracy(balanced): 72.45
I0208 12:59:13.308438 140125541349184 eval.py:52] Accuracy(Unbalanced): 68.36
I0208 12:59:13.308624 140125541349184 eval.py:53] Accuracy(Sparse Categorical) 68.36
I0208 12:59:13.308723 140125541349184 eval.py:54] recall: ['93.50%', '94.72%', '92.31%', '97.02%', '2.70%', '52.34%', '80.58%', '66.40%']
I0208 12:59:13.308809 140125541349184 eval.py:55] precision: ['92.00%', '69.81%', '98.63%', '98.00%', '4.08%', '34.76%', '98.53%', '86.61%']
I0208 12:59:13.308885 140125541349184 eval.py:56] macro_f1_score: 72.62
I0208 12:59:13.470234 140125541349184 eval.py:60] ----Evaluation completed----
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (2.1.0) or chardet (5.2.0) doesn't match a supported version!
  warnings.warn("urllib3 ({}) or chardet ({}) doesn't match a supported "
wandb: 
wandb: Run history:
wandb:         macro_f1_score █▆▁▁▁▂▅
wandb:                   step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███
wandb: test_balanced_accuracy ▄▄▁▂▄▅█
wandb:        test_sparse_acc █▄▁▂▂▄▄
wandb:              train_acc ▁▃▄▅▅▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█████████████████
wandb:             train_loss █▃▃▃▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                val_acc ▁▅▆▆▇▇██████████████████████████████████
wandb:               val_loss █▇▆▅▄▄▃▃▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:         macro_f1_score 72.62496
wandb:                   step 2000
wandb: test_balanced_accuracy 72.44751
wandb:        test_sparse_acc 68.36321
wandb:              train_acc 90.40839
wandb:             train_loss 0.28187
wandb:                val_acc 90.61292
wandb:               val_loss 0.34811
wandb: 
wandb: 🚀 View run /home/RUS_CIP/st184584/dl-lab-23w-team10/experiments_har/run_2024-02-08T12-58-44-080392 at: https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy/runs/h36txdhq
wandb: ️⚡ View job at https://wandb.ai/dl-lab-uni-stuttgart/diabetic-retinopathy/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjk3ODAzMA==/version_details/v34
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240208_125844-h36txdhq/logs
